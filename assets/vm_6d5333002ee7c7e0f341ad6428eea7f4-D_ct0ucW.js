var it=Object.defineProperty;var at=(r,e,t)=>e in r?it(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var l=(r,e,t)=>at(r,typeof e!="symbol"?e+"":e,t);import{t as q,R as Ee,m as W,v as U,i as V,l as z,x as lt,k as ae,p as g,n as j,f as J,y as De,r as h,g as B,w as Q,h as fe,j as m,o as _e,d as Ue,q as Oe,z as ot,A as ut,c as X,D as xe,S as Me,a as Y,B as ct,E as dt,F as Te,G as le,I as ht}from"./index-BoMhpNC_.js";import{i as qe,n as ve,e as mt,B as pt}from"./index-4b6efSp6.js";import{i as ft,t as $,a as ne,p as D,r as de,b as ze}from"./index-f9Y-iN-l.js";import{i as Ae}from"./is-null-D6OXYL3N.js";import{f as gt}from"./flatten-children-DQnOEoxH.js";import{u as Se,a as Ft}from"./index-Bx9N1tDu.js";import{G as _t}from"./index-xbke7J4T.js";import{p as Pe}from"./pick-BK4giCUn.js";function vt(r,e){return r.length===e.length&&r.every((t,s)=>t===e[s])}function yt(r){return q(r)==="Date"}function It(r){return q(r)==="Object"}const Vt=ft?Ee.useLayoutEffect:Ee.useEffect,ge=W(null),v=()=>{},oe=W({getFieldError:v,getFieldValue:v,getFieldsError:v,getFieldsValue:v,getInternalHooks:()=>({dispatch:v,registerField:v,setFields:v,updateControlsMap:v,registerWatch:v,setInternalFormProps:v,collectDependencies:v,updateDependencies:v,mergeInitialValues:v,initInitialValue:v}),isFieldTouched:v,isFieldValidating:v,isFieldsTouched:v,isFieldsValidating:v,resetFields:v,setFieldValue:v,setFieldsValue:v,submitForm:v,validateField:v,validateFields:v}),We=W({validateTrigger:void 0}),ie=W(null);class he extends Error{constructor(t,s){super("mink-ui 'Field' validation error. has 'errors', 'warnings', 'path' property");l(this,"errors");l(this,"warnings",[]);l(this,"path");const n=$(t==null?void 0:t.issues);this.path=s.path,this.errors=n.length===0?[`validation error on field '${s.path.join(".")}'`]:n.map(i=>i.message),n.length===0&&console.error(t)}}class K extends Error{constructor(t){super("mink-ui 'form.validateFields' method failed. has errors property");l(this,"errors");this.errors=t}static from(t){const s=t.reduce((n,i)=>(i.status==="fulfilled"&&i.value&&n.push(i.value),n),[]);return s.length===0?null:new K(s)}}class bt extends Error{constructor(t,s,n){var i,a,o,u;super("mink-ui 'Form' validation error");l(this,"errorFields");l(this,"isExpired");l(this,"values");l(this,"firstMessage");this.isExpired=s,this.errorFields=((i=t==null?void 0:t.errors)==null?void 0:i.map(c=>({errors:c.errors,name:c.path})))||[],this.values=n,this.firstMessage=((u=(o=(a=t==null?void 0:t.errors)==null?void 0:a[0])==null?void 0:o.errors)==null?void 0:u[0])||""}toJSON(){return{isExpired:this.isExpired,values:this.values,message:this.firstMessage,errorFields:this.errorFields}}}function P(r){return $(r).reduce((e,t,s)=>`${e}${s>0?"_":""}${q(t)}:${t}`,"")}function $t(r,...e){const t=r.length;return e.every(s=>s<t&&s>=0)}function wt(r,e){const t=Math.min(r.length,e.length);for(let s=0;s<t;s++)if(r[s]!==e[s])return!1;return t>0}function Ct(r,e){return!!r.length&&r.every((t,s)=>t===e[s])}function Re(r,e){return z(r)?[...r]:U(r)?{...r}:V(r)&&ae(e)?[]:{...r}}function Be(r,e,t,s){if(s>=e.length)return t;const n=e[s],i=Re(r,n);return i[n]=Be(i[n],e,t,s+1),i}function Et(r,e,t){return U(r)?Be(r,e,t,0):r}function k(r,e){const t=e.length;for(let s=0;s<t;s++){if(V(r))return;r=r[e[s]]}return t>0?r:void 0}function Ge(r,e,t){if(t>=e.length)return r;const s=e[t];if(!U(r)||!lt(r,s))return r;const n=Re(r,s);return t===e.length-1?delete n[s]:n[s]=Ge(n[s],e,t+1),n}function xt(r,e){return U(r)?Ge(r,e,0):r}function He(r,e,t=new WeakMap){if(t.has(r))return t.get(r);if(q(r)!==q(e)||!z(r)&&!It(r))return e;const s=z(r)?[]:{...r};return t.set(r,s),Object.entries(e).reduce((n,[i,a])=>(n[i]=He(r[i],a,t),n),s)}function Mt(r,...e){const t=z(r)?[...r]:{...r};return e.reduce((s,n)=>He(s,n),t)}function Ke(r,e,t,s){if(s>=e.length)return t;const n=e[s];let i={};return U(r[n])?i=r[n]:ae(e[s+1])&&(i=[]),r[n]=Ke(i,e,t,s+1),r}function Je(r,e,t){return U(r)?Ke(r,e,t,0):r}const St=Symbol.for("_$mink-ui-form-field$_"),me=Symbol.for("_$field-validate-finish$_"),Pt=Symbol.for("_$field-validate-initial$_");class kt{constructor(e,t){l(this,"_getInitialValue");l(this,"lastValidate",me);l(this,"_mounted",!1);l(this,"_dirty",!1);l(this,"refresh");l(this,"forceUpdate");l(this,"_firstState");l(this,"_errors",[]);l(this,"_id","");l(this,"_name",[]);l(this,"_props",{});l(this,"_touched",!1);l(this,"_validating",!1);l(this,"_preValidating",!1);l(this,"_warnings",[]);l(this,"__behavior","clean");l(this,"setInternalFieldProps",e=>{this._props=e,this._name!==e.name&&(this._id=P(e.name),this._name=$(e.name))});l(this,"setGetInitialValue",e=>{this._getInitialValue=e});l(this,"triggerMetaChange",e=>{const{children:t,onMetaChange:s}=this._props;s==null||s(e),j(t)&&this.forceUpdate()});l(this,"markIsMounted",e=>{this._mounted=!0,!this._firstState&&(this._firstState={value:e.getFieldValue(this._name)})});l(this,"markIsUnmounted",()=>{this._mounted=!1,this.triggerMetaChange({...this.getMetaData(),mounted:!1})});l(this,"markCleanBehavior",e=>{this.__behavior=e});l(this,"isFormList",()=>!!this._props.isFormList);l(this,"hasInitialValue",()=>!g(this._props.initialValue));l(this,"getFieldInfo",e=>{const t={...this.getMetaData(),name:this._name,value:e};return Object.defineProperty(t,St,{value:!0}),t});l(this,"getMetaData",()=>({dirty:this.dirty,errors:this._errors,name:this._name,touched:this._touched,validating:this._validating,warnings:this._warnings,validated:this.lastValidate===me}));l(this,"getErrorInfo",()=>({name:this._name,errors:this._errors,warnings:this._warnings}));l(this,"metaUpdate",e=>{const t=this.getMetaData();V(e.dirty)||(this._dirty=e.dirty),V(e.touched)||(this._touched=e.touched),V(e.errors)||(this._errors=e.errors),V(e.warnings)||(this._warnings=e.warnings),V(e.validating)||(this._validating=e.validating);const s=this.getMetaData();ne(t,s)||!this._mounted||this.triggerMetaChange({...s,mounted:!0})});l(this,"resetField",()=>{var e,t;this.metaUpdate({touched:!1,dirty:!1,validating:!1,errors:[],warnings:[]}),this.lastValidate=Pt,(t=(e=this._props).onReset)==null||t.call(e),this.refresh()});l(this,"shouldUpdate",(e,t,s)=>{const{_id:n,_name:i,_props:{shouldUpdate:a}}=this;return a===!0?!0:j(a)?a(e,t,s):!!n&&k(e,i)!==k(t,i)});l(this,"validate",e=>{this.metaUpdate({dirty:!0,errors:[],warnings:[],validating:!0});const t=Promise.resolve().then(()=>{const{rule:s}=this._props;if(!this._mounted||!this._id||!s)return null;const n=s.validate(e,{path:this._name}).catch(i=>new he(i,{path:this._name})).then(i=>i instanceof he?i:null);return n.then(i=>{if(this.lastValidate!==t)return;this.lastValidate=me;const a=i instanceof he,o=a?i.errors:[],u=a?i.warnings:[];this.metaUpdate({errors:o,warnings:u,validating:!0})}),n});return this.lastValidate=t,t});this.forceUpdate=()=>{this._mounted&&e()},this.refresh=()=>{this._mounted&&t()}}get dirty(){var e;return this._dirty||!g((e=this._getInitialValue)==null?void 0:e.call(this))}}class jt{constructor(e){l(this,"_name");l(this,"_props",{});l(this,"getMetaData",()=>null);l(this,"getErrorInfo",()=>({name:this._name,errors:[],warnings:[]}));this._name=$(e)}}function Nt(r,e){let t=!1,s,n;return r===!0||z(r)?(n=r,s=e):U(r)&&(t=!!r.strict,s=r.filter),[t,n,s]}function Lt(r,e){let t,s=!1;return qe(r)?(t=void 0,s=!!r):(s=!!e,t=r),[t,s]}const ee=Symbol.for("_$mink$_");class Dt{constructor(e){l(this,"$controls");l(this,"$dispatch");l(this,"$initial");l(this,"$props");l(this,"$state");l(this,"getInternalHooks",e=>{if(!(e===ee))return;const{$dispatch:s,$controls:n,$initial:i,$props:a}=this,{$dependencies:o,$watch:u}=s;return{dispatch:s.dispatch,registerField:s.registerField,setFields:s.setFields,updateControlsMap:n.updateControlsMap,registerWatch:u.registerWatch,setInternalFormProps:a.setInternalFormProps,collectDependencies:o.collectDependencies,updateDependencies:o.updateDependencies,mergeInitialValues:i.mergeInitialValues,initInitialValue:i.initInitialValue}});l(this,"injectForm",()=>{const{$controls:e,$dispatch:t,$state:s}=this;return{getInternalHooks:this.getInternalHooks,getFieldError:e.getFieldError,getFieldValue:s.getFieldValue,getFieldsError:e.getFieldsError,getFieldsValue:s.getFieldsValue,isFieldTouched:e.isFieldTouched,isFieldValidating:e.isFieldValidating,isFieldsTouched:e.isFieldsTouched,isFieldsValidating:e.isFieldsValidating,resetFields:t.resetFields,setFieldValue:t.setFieldValue,setFieldsValue:t.setFieldsValue,submitForm:t.submitForm,validateField:t.validateField,validateFields:t.validateFields}});this.forceUpdate=e,this.$props=new Ut(e),this.$controls=new zt,this.$state=new At(this.$controls),this.$initial=new qt(this.$props,this.$state,this.$controls),this.$dispatch=new Wt(this.$props,this.$state,this.$controls,this.$initial)}}class Ut{constructor(e){l(this,"_formProvider",null);l(this,"_props",{});l(this,"setInternalFormProps",(e,t)=>{this._props=e,this._formProvider=t});l(this,"isKeepFieldValue",e=>{const{preserve:t}=this._props,{preserve:s}=e._props;return s??t??!0});this.forceUpdate=e}get isFunctional(){return j(this._props.children)}}class Ot{constructor(){l(this,"_dependencies",new Map);l(this,"traverseDependencies",(e,t)=>{if(!e.length)return;const s=[],n=this._dependencies;e.forEach(i=>{var a;(a=n.get(i._id))==null||a.forEach(o=>{t.has(o)||(s.push(o),t.add(o))})}),this.traverseDependencies(s,t)});l(this,"collectDependencies",e=>{const{dependencies:t=[]}=e._props,s=this._dependencies;return t.forEach(n=>{const i=P(n);if(!i||i===e._id)return;const a=s.get(i)||new Set;s.set(i,a.add(e))}),()=>{this.cleanDependencies(e)}});l(this,"cleanDependencies",e=>{this._dependencies.forEach((t,s)=>{t.delete(e),t.size||this._dependencies.delete(s)})});l(this,"updateDependencies",e=>{this.cleanDependencies(e),this.collectDependencies(e)})}}class Tt{constructor(){l(this,"_watchList",new Set);l(this,"publishWatch",()=>{this._watchList.forEach(mt)});l(this,"registerWatch",e=>(this._watchList.add(e),()=>{this._watchList.delete(e)}))}}class qt{constructor(e,t,s){l(this,"_initialValues",{});l(this,"getFromInitialValue",e=>k(this._initialValues,$(e)));l(this,"getFieldInitialValue",e=>{for(let s=0;s<e.length;s++){const n=e[s],{isListField:i}=n._props;if(!i)continue;const{listPath:a,listControl:o}=i;if(!o)continue;const u=n._name.slice(a.length),c=k(o._props.initialValue,u);if(!g(c))return c}const t=e.find(s=>s.hasInitialValue());if(t)return t._props.initialValue});l(this,"getInitialValue",e=>{const t=this.getFromInitialValue(e._name);return g(t)?this.getFieldInitialValue([e]):t});l(this,"mergeInitialValues",e=>{this._initialValues=e||{},this.$state.mergeFieldsValue(this._initialValues,this.$state._state)});l(this,"initInitialValue",e=>{const{initialValue:t}=e._props;if(!e._id||g(t))return;const s=this.$state.getFieldValue(e._name);g(s)&&this.$state.setFieldValue(e._name,t)});l(this,"triggerTwiceUpdate",(e,t,s)=>{const{type:n,control:i,fieldTransient:a}=e,{forceUpdate:o,shouldUpdate:u}=i,c=this.$state.getFieldValue(i._name);if(a!==c)return o();const d=J(t,this.$state._state),p=J(s,this.$state._state);return u(d,p,n)?o():null});l(this,"ensureInitialValue",e=>{const{$state:t}=this,{_firstState:s,_props:{isListField:n,initialValue:i}}=e;if(s)return t.getFieldValue(e._name)===s.value?void 0:t.setFieldValue(e._name,s.value);if(!(!e._id||g(i)||!n&&!g(this.getFromInitialValue(e._name))||(this.$controls._map.get(e._id)||[]).filter(o=>o.hasInitialValue()).length>1)&&g(t.getFieldValue(e._name)))return t.setFieldValue(e._name,this.getInitialValue(e))});l(this,"cleanFieldInitialValue",e=>{const{$controls:t,$state:s,$props:n}=this,{isListField:i}=e._props;if(!e._id||n.isKeepFieldValue(e)||t._map.has(e._id)||i&&i.type==="simple"||i&&e.__behavior==="keep")return;const a=i&&e.__behavior==="clean"?void 0:this.getFromInitialValue(e._name);if(g(a))return s.deleteFieldValue(e._name);if(a!==s.getFieldValue(e._name))return s.setFieldValue(e._name,a)});l(this,"cleanListInitialValue",e=>{const t=this.$props.isKeepFieldValue(e)?"keep":"none";return this.$controls.markFormListChildrenBehavior(e,t),this.cleanFieldInitialValue(e)});l(this,"cleanInitialValue",e=>{const{isFormList:t}=e._props;return t?this.cleanListInitialValue(e):this.cleanFieldInitialValue(e)});l(this,"resetInitialValues",(e,t)=>{const{$state:s}=this,n=s._state;return t||s.mergeFieldsValue({},this._initialValues),e.forEach((i,a)=>{if(!a||!i.length)return;const o=i[0]._name,u=this.getFromInitialValue(o);if(!g(u))return u===s.getFieldValue(o)?void 0:s.setFieldValue(o,u);const c=this.getFieldInitialValue(i);if(g(c))return t&&s.deleteFieldValue(o);c!==s.getFieldValue(o)&&s.setFieldValue(o,c)}),[n,s._state]});this.$props=e,this.$state=t,this.$controls=s}}class zt{constructor(){l(this,"_list",[]);l(this,"_map",new Map);l(this,"registerControl",(e,t)=>(e.setGetInitialValue(()=>t.getInitialValue(e)),D(this._list,e),this._map.set(e._id,D(this._map.get(e._id)||[],e)),()=>{de(this._list,e),de(this._map.get(e._id)||[],e).length||this._map.delete(e._id)}));l(this,"updateControlsMap",(e,t)=>{const s=P(t);de(this._map.get(s)||[],e).length===0&&this._map.delete(s);const i=this._map.get(e._id)||[];i.includes(e)||this._map.set(e._id,D(i,e))});l(this,"getFormListFieldControls",e=>this._list.filter(t=>{const{isListField:s}=t._props;return s&&vt(s.listPath,e._name)}));l(this,"markFormListChildrenBehavior",(e,t)=>{this.getFormListFieldControls(e).forEach(s=>{s.markCleanBehavior(t)})});l(this,"getGetFieldsValueControls",e=>{if(g(e))return this._list.filter(s=>s._id);const t=new Set;return e.reduce((s,n)=>{const i=P(n);if(!i||t.has(i))return s;t.add(i);const a=this._map.get(i);return a?D(s,a[a.length-1]):s.push(new jt(n)),s},[])});l(this,"getFieldsErrorControls",e=>this.getGetFieldsValueControls(e));l(this,"getGetFieldsControls",e=>{if(g(e))return this._list.filter(s=>s._id);const t=new Set;return e.reduce((s,n)=>{const i=P(n),a=this._map.get(i);return!i||!a||t.has(i)?s:(t.add(i),D(s,a))},[])});l(this,"getFieldsValidatingControls",e=>{if(g(e))return this._list;const t=new Set;return e.reduce((s,n)=>{const i=P(n),a=this._map.get(i);return!a||t.has(i)?s:(t.add(i),D(s,a))},[])});l(this,"getFieldsTouchedControls",e=>{if(g(e))return[this._list.filter(n=>n._id)];const t=new Map,s=e.map(n=>[P(n),$(n)]);return this._map.forEach((n,i)=>{if(!i)return;const a=n[0]._name;s.forEach(([o,u])=>{Ct(u,a)&&t.set(o,D(t.get(o)||[],n))})}),Array.from(t.values())});l(this,"getValidateFieldsControls",e=>{if(g(e))return this._list.filter(s=>s._id&&s._props.rule);const t=new Set;return e.reduce((s,n)=>{const i=P(n),a=this._map.get(i);return!i||!a||t.has(i)?s:(t.add(i),D(s,a.filter(o=>o._props.rule)))},[])});l(this,"getResetFieldsControlsMap",e=>{const t=new Map,s=new Map,n=g(e)?Array.from(this._map.values(),a=>a[0]._name):e,i=new Set;return n.forEach(a=>{const o=P(a),u=this._map.get(o);if(!u||i.has(o))return;i.add(o),u.some(d=>d.isFormList())?s.set(o,u):t.set(o,u)}),s.forEach((a,o)=>{t.set(o,a)}),t});l(this,"getFieldError",e=>this.getFieldsError([e])[0].errors);l(this,"getFieldsError",e=>this.getFieldsErrorControls(e).map(t=>t.getErrorInfo()));l(this,"isFieldTouched",e=>this.isFieldsTouched([e]));l(this,"isFieldsTouched",(e,t)=>{const[s,n]=Lt(e,t),i=this.getFieldsTouchedControls(s);return g(s)?n?i[0].every(a=>a._touched||a.isFormList()):i[0].some(a=>a._touched):n?i.every(a=>a.some(o=>o._touched)):i.some(a=>a.some(o=>o._touched))});l(this,"isFieldValidating",e=>this.isFieldsValidating([e]));l(this,"isFieldsValidating",e=>this.getFieldsValidatingControls(e).some(t=>!!t._validating));l(this,"updateSetFieldsValueControlsMeta",(e,t)=>{this._list.forEach(s=>{const{_id:n,_name:i}=s;!n||k(e,i)===k(t,i)||s.metaUpdate({touched:!0,dirty:!0,validating:!1,errors:[],warnings:[]})})});l(this,"updateSetFieldsControlsMeta",e=>{e.forEach(t=>{(this._map.get(P(t.name))||[]).forEach(n=>{n.metaUpdate(t)})})})}}class At{constructor(e){l(this,"_state",{});l(this,"deleteFieldValue",e=>{const t=this._state;return this._state=xt(this._state,e),[t,this._state]});l(this,"getFields",e=>this.$controls.getGetFieldsControls(e).map(t=>t.getFieldInfo(this.getFieldValue(t._name))));l(this,"getFieldValue",e=>k(this._state,$(e)));l(this,"getFieldsValue",(e,t)=>{const[s,n,i]=Nt(e,t),a=this._state;if(n===!0&&!i)return a;const o=!g(n);return this.$controls.getGetFieldsValueControls(z(n)?n:void 0).reduce((u,c)=>{const{_name:d}=c,{isFormList:p,isListField:f}=c._props;return s&&p||!s&&f&&!o||i&&!i(c.getMetaData())?u:Je(u,d,k(a,d))},{})});l(this,"setFieldValue",(e,t)=>{const s=this._state,n=$(e);return n.length?(this._state=Et(this._state,n,t),[s,this._state]):[s,s]});l(this,"setFieldsData",e=>{const t=this._state;return e.forEach(s=>{"value"in s&&this.setFieldValue(s.name,s.value)}),[t,this._state]});l(this,"mergeFieldsValue",(e,t)=>{const s=this._state;return this._state=Mt(e,t),[s,this._state]});this.$controls=e}}class Wt{constructor(e,t,s,n){l(this,"lastValidate",null);l(this,"$dependencies",new Ot);l(this,"$watch",new Tt);l(this,"updateControl",e=>{let t=[];return this.$props.isFunctional?this.$props.forceUpdate():t=this.$controls._list.filter(e),t.forEach(s=>{s.forceUpdate()}),t});l(this,"dispatch",e=>{const{$watch:t,$state:s,$controls:n,$initial:i}=this;if(e.type==="registerField"){const{type:a,control:o}=e,[u,c]=i.ensureInitialValue(o)||[];o.markIsMounted(s);const d=i.triggerTwiceUpdate(e,u,c);if(g(u)||g(c))return;this.updateControl(p=>Ae(d)?wt(o._name,p._name)?!0:p.shouldUpdate(u,c,a):!1),t.publishWatch();return}if(e.type==="unregisterField"){const{type:a,control:o}=e,[u,c]=i.cleanInitialValue(o)||[];if(o.markIsUnmounted(),g(u)||g(c))return;const d=this.updateControl(p=>p.shouldUpdate(u,c,a));t.publishWatch(),this.publishDependentControl(d);return}if(e.type==="fieldEvent"){const{type:a,control:o,value:u}=e,[c,d]=s.setFieldValue(o._name,u);o.metaUpdate({dirty:!0,touched:!0});const p=this.updateControl(F=>F._id&&F._id===o._id?!0:F.shouldUpdate(c,d,a));t.publishWatch();const f=this.publishDependentControl(p);this.triggerOnValuesChange(d,o._name),this.triggerOnFieldsChange([o,...f]);return}if(e.type==="resetFields"){const{type:a,nameList:o}=e,u=!g(o),c=n.getResetFieldsControlsMap(o),[d,p]=i.resetInitialValues(c,u);this.updateControl(f=>!u||c.has(f._id)?!1:f.shouldUpdate(d,p,a)),c.forEach(f=>{f.forEach(F=>{F.resetField()})}),t.publishWatch();return}if(e.type==="setFieldsValue"){const{type:a,state:o}=e,[u,c]=s.mergeFieldsValue(s._state,o);this.updateControl(d=>d.shouldUpdate(u,c,a)),n.updateSetFieldsValueControlsMeta(u,c),t.publishWatch();return}if(e.type==="setFields"){const{type:a,fields:o}=e,[u,c]=s.setFieldsData(o);this.updateControl(d=>d.shouldUpdate(u,c,a)),n.updateSetFieldsControlsMeta(o),t.publishWatch()}});l(this,"publishDependentControl",e=>{const t=new Set;this.$dependencies.traverseDependencies(e,t),t.forEach(i=>{i.forceUpdate()});const s=Array.from(t),n=s.map(i=>i._name);return n.length&&this.validateFields(n),s});l(this,"registerField",(e,t)=>{const s=this.$controls.registerControl(e,this.$initial);return this.dispatch({type:"registerField",control:e,fieldTransient:t}),()=>{s(),this.dispatch({type:"unregisterField",control:e})}});l(this,"resetFields",e=>{this.dispatch({type:"resetFields",nameList:e})});l(this,"setFieldValue",(e,t)=>{this.dispatch({type:"setFields",fields:[{name:e,value:t,errors:[],warnings:[]}]})});l(this,"setFields",e=>{this.dispatch({type:"setFields",fields:e})});l(this,"setFieldsValue",e=>{this.dispatch({type:"setFieldsValue",state:e})});l(this,"submitForm",()=>{this.validateFields().then(this.triggerOnFinish,this.triggerOnFailed)});l(this,"triggerOnFinish",e=>{const{onFinish:t}=this.$props._props;if(t)try{t(e)}catch(s){console.error(s)}});l(this,"triggerOnFailed",e=>{var t,s;(s=(t=this.$props._props).onFailed)==null||s.call(t,e.toJSON())});l(this,"triggerOnFieldsChange",e=>{const{name:t,onFieldsChange:s}=this.$props._props,n=this.$props._formProvider;if(!s&&!n)return;const{getFields:i}=this.$state,a=i(e.map(o=>o._name));!g(t)&&(n==null||n.triggerFormChange(t,a)),s==null||s(a,()=>i())});l(this,"triggerOnValuesChange",(e,t)=>{const{onValuesChange:s}=this.$props._props;if(!s)return;const n=Je({},t,k(e,t));s(n,()=>this.$state.getFieldsValue())});l(this,"validateField",e=>{this.validateFields([e])});l(this,"validateFields",e=>{const{$state:t,$controls:s}=this,n=s.getValidateFieldsControls(e),i=n.map(u=>u.validate(t.getFieldValue(u._name))),a=Promise.resolve().then(()=>Promise.allSettled(i).then(u=>K.from(u)).then(u=>u instanceof K?u:null));this.lastValidate=a,this.triggerOnFieldsChange(n);const o=a.then(u=>{this.triggerOnFieldsChange(n);const c=u instanceof K,d=a!==this.lastValidate,p=t.getFieldsValue(e);return!d&&!c?p:Promise.reject(new bt(u,d,p))});return o.catch(ve),o});this.$props=e,this.$state=t,this.$controls=s,this.$initial=n}}function Rt(r,e,t){const s=De(),[n,i]=h.useReducer(u=>u+1,0),a=B(()=>new kt(s,i));h.useMemo(()=>{a.setInternalFieldProps(t)},[a,t]),B(()=>{r.initInitialValue(a)});const o=B(()=>e.getFieldValue(a._name));return Vt(()=>r.registerField(a,o),[r,a,o]),h.useEffect(()=>r.collectDependencies(a),[r,a]),[a,n]}const ke={trigger:"onChange",valuePropName:"value"};function Bt(r,e,t,s,n){const{name:i,rule:a,trigger:o,validateTrigger:u,formatter:c,getValueProps:d,getValueFromEvent:p}=n;return(f={})=>{const F=t.getFieldValue(i),w={...f,...s._id?d(F):null,[o]:(...I)=>{var M;let b=p(...I);j(c)&&(b=c(b,F,()=>t.getFieldsValue(!0))),b!==F&&r.dispatch({type:"fieldEvent",control:s,value:b}),o&&((M=f[o])==null||M.call(f,...I))}};return $(J(u,e.validateTrigger)).reduce((I,b)=>(b===!1||(I[b]=(...M)=>{var T;(T=w[b])==null||T.call(w,...M),a&&t.validateField(i)}),I),{...w})}}function Gt(r,e,t){return function s(n){if(j(n)){const a=n(r(),t.getMetaData(),e);return{...s(a),functional:!0}}const i=gt(n);return i.length===1&&h.isValidElement(i[0])?{children:i[0],valid:!0}:{children:i,valid:!1}}}function Ht(r,e,t,s,n){const i=Bt(r,e,t,s,n),a=Gt(i,t,s),{children:o,functional:u,valid:c}=a(n.children);if(u||!c)return o;const d=i(o.props);return h.cloneElement(o,d)}function Kt(r){return(...e)=>{const t=e[0];return!t||!U(t.target)||!(r in t.target)?t:t.target[r]}}function Jt(r){return e=>({[r]:e})}function Zt(r){const e=h.useMemo(()=>{const p=J(r.valuePropName,ke.valuePropName);return Q(r,{...ke,getValueProps:Jt(p),getValueFromEvent:Kt(p)})},[r]),{name:t,dependencies:s}=e,n=oe.useState(),i=We.useState(),a=h.useMemo(()=>n.getInternalHooks(ee),[n]),[o,u]=Rt(a,n,e),c=fe(t,{compare:ne,listener:(p,f)=>{a.updateControlsMap(o,f)}}),d=fe(s,{compare:ne,listener:()=>{a.updateDependencies(o)}});return c||d?null:m.jsx(h.Fragment,{children:Ht(a,i,n,o,e)},u)}function Ze(r){const{name:e,preserve:t}=r,s=ie.useState(),n=(s==null?void 0:s.listPath)||[],i=s==null?void 0:s.listControl,a=$(e),o=g(e)?[]:n.concat(a);let u;return s?n.length===0||a.length===0?u=!1:a.length>1?u={type:"complex",listPath:n,listControl:i}:u={type:"simple",listPath:n,listControl:i}:u=!1,h.createElement(Zt,{...r,key:u?"controlled":P(o),isListField:u,name:o})}function Qe(r){const e=De();return B(()=>r||new Dt(e).injectForm())}function Qt(r,e){const t=h.useRef(e);h.useEffect(()=>{e&&!ne(t.current,e)&&r.setFields(e),t.current=e},[e,r])}const Xt={preserve:!0,tag:"form",validateTrigger:"onChange"},Yt=["name","tag","form","children","onReset","initialValues","validateTrigger","preserve","validationSchema","fields","onFinish","onFieldsChange","onValuesChange","onFailed"];function es(r,e){const t=h.useMemo(()=>Q(r,Xt),[r]),{children:s,fields:n,form:i,initialValues:a,name:o,tag:u,validateTrigger:c,onReset:d}=t,p=ge.useState(),f=Qe(i);h.useImperativeHandle(e,()=>f,[f]);const F=h.useMemo(()=>f.getInternalHooks(ee),[f]);h.useMemo(()=>{F.setInternalFormProps(t,p)},[F,p,t]),B(()=>{F.mergeInitialValues(a)}),h.useEffect(()=>p==null?void 0:p.register(f,o),[f,o,p]),Qt(F,n);const w=y=>{y==null||y.preventDefault(),y==null||y.stopPropagation(),f.submitForm()},x=y=>{y==null||y.preventDefault(),y==null||y.stopPropagation(),f.resetFields(),d==null||d(y)},I=h.useMemo(()=>f,[f]),b=h.useMemo(()=>({validateTrigger:c}),[c]),M=m.jsx(ie.Provider,{value:null,children:m.jsx(We.Provider,{value:b,children:m.jsx(oe.Provider,{value:I,children:j(s)?s(f.getFieldsValue(!0),f):s})})});if(V(u))return M;const T={..._e(t,Yt),onReset:x,onSubmit:w};return h.createElement(u,T,M)}const ts=h.forwardRef(es);function Xe(r,e){const[t,s]=Ue(void 0),n=oe.useState(),i=e??n,a=h.useMemo(()=>i==null?void 0:i.getInternalHooks(ee),[i]),o=ze(()=>$(r),[r]),u=Oe(()=>{const c=()=>{const d=i==null?void 0:i.getFieldValue(o);ot(d,t)||s(d)};return c(),a==null?void 0:a.registerWatch(c)});return h.useEffect(u,[u,o]),t}class ss{constructor(){l(this,"_props",{});l(this,"_instance",null);l(this,"_id",0);l(this,"_keys",[]);l(this,"_listPath",[]);l(this,"_rule");l(this,"append",e=>{this._keys=this._keys.concat(this._id),this.dispatchEvent(this.getFieldList().concat(e)),this._id+=1});l(this,"dispatchEvent",e=>{var s,n;const t=(s=this._instance)==null?void 0:s.getInternalHooks(ee);t==null||t.dispatch({type:"setFields",fields:[{name:this._listPath,value:e}]}),this._rule&&((n=this._instance)==null||n.validateFields([this._listPath]))});l(this,"getFieldList",()=>{var t;const e=(t=this._instance)==null?void 0:t.getFieldValue(this._listPath);return $(e,!0)});l(this,"insert",(e,t)=>{const s=this.getFieldList().concat();s.splice(e,0,t),this._keys.splice(e,0,this._id),this.dispatchEvent(s),this._id+=1});l(this,"move",(e,t)=>{let s=this.getFieldList();$t(s,e,t)&&(s=s.concat(),s.splice(t,0,s.splice(e,1)[0]),this._keys.splice(t,0,this._keys.splice(e,1)[0]),this.dispatchEvent(s))});l(this,"prepend",e=>{this._keys=[this._id,...this._keys],this.dispatchEvent([e].concat(this.getFieldList())),this._id+=1});l(this,"remove",e=>{const t=new Set($(e)),s=(i,a)=>t.size>0&&!t.has(a),n=this.getFieldList();this._keys=this._keys.filter(s),this.dispatchEvent(n.filter(s))});l(this,"replace",(e,t)=>{const s=this.getFieldList();s[e]=t,this.dispatchEvent(s)});l(this,"swap",(e,t)=>{const s=this.getFieldList();[s[e],s[t]]=[s[t],s[e]];const n=this._keys;[this._keys[e],this._keys[t]]=[n[t],n[e]],this.dispatchEvent(s)});l(this,"ensureFieldKey",e=>{const t=this._keys[e];return g(t)&&(this._keys[e]=this._id,this._id+=1),this._keys[e]});l(this,"getFeatures",()=>({append:this.append,insert:this.insert,move:this.move,prepend:this.prepend,remove:this.remove,replace:this.replace,swap:this.swap}));l(this,"setInternalListProps",(e,t,s)=>{this._props=e,this._instance=t,this._listPath=s})}}function rs(r){const{children:e,initialValue:t,name:s,rule:n}=r,i=oe.useState(),a=ie.useState(),o=ze(()=>a!=null&&a.listPath?a.listPath.concat($(s)):$(s),[a==null?void 0:a.listPath,s]),u=B(()=>new ss);h.useMemo(()=>{u.setInternalListProps(r,i,o)},[u,r,i,o]);const c=h.useMemo(()=>({listPath:o,listControl:u}),[o,u]),d=h.useMemo(()=>u.getFeatures(),[u]);return!j(e)||!P(s)?null:m.jsx(Ze,{initialValue:t,name:s,rule:n,isFormList:!0,shouldUpdate:(f,F)=>{const w=$(s),x=k(f,w),I=k(F,w);return q(x)!==q(I)?!0:z(I)&&x.length!==I.length},children:({value:f},F)=>{const w=$(f,!0).map((x,I)=>({key:u.ensureFieldKey(I),name:I}));return m.jsx(ie.Provider,{value:c,children:e(w,d,F)})}})}function ns(r){const e=h.useRef({}),t=ge.useState(),s=h.useMemo(()=>({register:ut(t==null?void 0:t.register,(n,i)=>i?(e.current[i]=n,()=>{delete e.current[i]}):ve),triggerFormChange:(n,i)=>{t==null||t.triggerFormChange(n,i)},triggerFormFinish:(n,i)=>{t==null||t.triggerFormFinish(n,i)}}),[t]);return m.jsx(ge.Provider,{value:s,children:r.children})}const te=Object.assign(ts,{Field:Ze,List:rs,Provider:ns,useForm:Qe,useWatch:Xe}),G=W({labelAlign:"right",layout:"horizontal"}),Ye=W({}),et=W(ve);function tt(r){return te.useForm(r)}function is(r,e){const{className:t,layout:s,requiredMark:n,size:i}=e;return X(r,{[`${r}--${s}`]:s,[`${r}--${i}`]:i,[`${r}--hide-required-mark`]:!n},t)}const as={colon:!0,layout:"horizontal",requiredMark:!0},ls=["form","colon","layout","labelAlign","labelWrap","labelCol","wrapperCol","size","disabled","scrollToFirstError","requiredMark"];function os(r,e){const t=Q(r,{...as,disabled:xe.useState(),size:Me.useState()}),{colon:s,disabled:n,form:i,labelAlign:a,labelCol:o,labelWrap:u,layout:c,name:d,onFailed:p,requiredMark:f,size:F,wrapperCol:w}=t,x=Y("form"),I=is(x,t),b=tt(i);h.useImperativeHandle(e,()=>b,[b]);const M=h.useMemo(()=>({colon:s,form:b,formName:d,labelAlign:a,labelCol:o,labelWrap:u,layout:c,requiredMark:f,wrapperCol:w}),[s,f,b,a,o,u,c,d,w]),T=ce=>{p==null||p(ce)},y=_e(t,ls);return m.jsx(xe.Provider,{value:n,children:m.jsx(Me.Provider,{value:F,children:m.jsx(G.Provider,{value:M,children:m.jsx(te,{...y,className:I,form:b,name:d,onFailed:T})})})})}const us=h.forwardRef(os);function cs(){return G.useState().form}function pe(r,e,t){return e.map((s,n)=>({key:h.isValidElement(s)?`${s.key}-${s.type}-${r}-${n}`:`${s}-${q(s)}`,status:J(t,r),value:s}))}function ds(r){const{help:e,helpStatus:t,errors:s,warnings:n}=r,i=Se(40,s||[]),a=Se(40,n||[]);return h.useMemo(()=>V(e)?D(pe("error",i),pe("warning",a)):pe("help",[e],t),[i,e,t,a])}const hs={onEnter:r=>{r.style.setProperty("height","0px")},onEntering:r=>{r.style.setProperty("height",`${r.scrollHeight}px`)},onEntered:r=>{r.style.removeProperty("height")},onEnterCancel:r=>{r.style.setProperty("height",`${r.offsetHeight}px`)},onExit:r=>{r.style.setProperty("height",`${r.offsetHeight}px`)},onExiting:r=>{r.style.setProperty("height","0px")},onExited:r=>{r.style.removeProperty("height")},onExitCancel:r=>{r.style.setProperty("height",`${r.offsetHeight}px`)}};function st(r){const{className:e,onFinished:t}=r,s=Y("form-item-message"),n=ds(r);return m.jsx("div",{className:X(s,e),children:m.jsx(_t,{appear:!0,classNames:`${s}-motion`,...hs,onFinished:t,children:n.map(i=>m.jsx("div",{className:`${s}--${i.status}`,children:i.value},i.key))})})}function ms(r,e,t={}){return{root:X(r,{[`${r}--has-${e}`]:!!e},t.className)}}function ps(r,e){const{getOuter:t}=r,[s,n]=Ue(0),i=()=>{!e&&n(0)},a=Oe(()=>{const u=t();if(!e||!u)return;const c=ct(u);n(Number.parseFloat(c.marginBottom))}),o=fe(e,a);return h.useEffect(()=>dt(a),[a]),{returnEarly:o,offset:s,cleanOffset:i}}function fs(){return{dirty:!1,errors:[],mounted:!1,name:[],touched:!1,validating:!1,warnings:[],validated:!1}}function je(){const[r,e]=Ft(80,fs),t=h.useCallback(s=>{s.mounted&&e(s)},[e]);return[r,t]}function gs(r,e){if(!V(e))return e;if(r.validating||r.validating)return"validating";if(r.errors.length)return"error";if(r.warnings.length)return"warning";if(r.touched)return"success"}function Fs(r){const e=G.useState(),t=Q(r,{wrapperCol:e.wrapperCol}),{children:s,extra:n,help:i,validateStatus:a,wrapperCol:o}=t,u=Y("form-item__control"),[c,d]=je(),[p,f]=je(),F=h.useMemo(()=>gs(c,a),[c,a]),w=ms(u,F,o),x=h.useMemo(()=>({validateStatus:F}),[F]),I=h.useMemo(()=>c.errors.concat(p.errors),[c.errors,p.errors]),b=h.useMemo(()=>c.warnings.concat(p.warnings),[c.warnings,p.warnings]),M=!V(i)||!!(I.length||b.length),{returnEarly:T,offset:y,cleanOffset:ce}=ps(t,M);return T?null:m.jsx(Te,{...o,className:w.root,children:m.jsxs(Ye.Provider,{value:x,children:[m.jsx("div",{className:`${u}-input`,children:s(d,f)}),!!(M||y)&&m.jsx("div",{className:`${u}-status`,style:{minHeight:y},children:m.jsx(st,{errors:I,help:i,helpStatus:F,warnings:b,onFinished:ce})}),!V(n)&&m.jsx("div",{className:`${u}-extra`,children:n}),!!y&&m.jsx("div",{className:`${u}-offset`,style:{marginBottom:-y}})]})})}function _s(r,e,t){const{colon:s,labelAlign:n,labelWrap:i,required:a,requiredMark:o,labelCol:u={}}=e;return{root:X(r,{[`${r}--align-${n}`]:n,[`${r}--colon`]:s,[`${r}--has-colon`]:s&&t.layout!=="vertical",[`${r}--required`]:a,[`${r}--required-optional`]:o==="optional",[`${r}--wrap`]:i},u.className)}}function vs(r,e){const{colon:t,label:s,required:n,requiredMark:i,tooltip:a}=r,o=e.layout!=="vertical"&&t;let u=s;return o&&le(u)&&(u=u.replace(/[:|：]\s*$/,"")),u}function ys(r){const e=G.useState(),t=Q(r,{colon:e.colon,labelAlign:e.labelAlign,labelCol:e.labelCol,labelWrap:e.labelWrap,requiredMark:e.requiredMark}),{htmlFor:s,label:n}=t,i=Y("form-item__label"),a=_s(i,t,e),o=le(n)?n:void 0;return m.jsx(Te,{...t.labelCol,className:a.root,children:m.jsx("label",{htmlFor:s,title:o,children:vs(t,e)})})}function rt(r,e){return h.useMemo(()=>{if(V(r))return;const t=$(r).join("_");return V(e)?t:`${e}_${t}`},[e,r])}function Is(r,e){const{className:t,hidden:s}=e;return{root:X(r,s&&`${r}--hidden`,t)}}function Vs(r){const{children:e,dependencies:t=[],name:s,shouldUpdate:n}=r,i=$(s).length,a=j(e);return i&&a||n&&t.length||a&&!(n||t.length)||t.length&&!(a||i)?!0:(i&&!a&&!h.isValidElement(e),!1)}function nt(r,e,t){const{children:s}=r;if(Vs(r))return()=>null;if(j(s))return()=>s(e);if(!h.isValidElement(s))return()=>s;const n=s.props.id;return V(t)||!V(n)?s:h.cloneElement(s,{id:t})}const bs=["colon","htmlFor","label","labelAlign","labelCol","labelWrap","requiredMark","tooltip"],$s=["wrapperCol","extra","help","validateStatus"];function ws(r){const{form:e,formName:t}=G.useState(),s=et.useState(),n=rt(r.name,t);return m.jsx(te.Field,{...r,onMetaChange:s,children:nt(r,e,n)})}function Cs(r){const{label:e,name:t,required:s,style:n}=r,{form:i,formName:a}=G.useState(),o=Y("form-item"),u=rt(t,a),c=Is(o,r),d=h.useRef(null),p=h.useCallback(()=>d.current,[]),f=Pe(r,bs),F=Pe(r,$s);return m.jsxs(ht,{ref:d,className:c.root,style:n,children:[!V(e)&&m.jsx(ys,{...f,htmlFor:u,required:s}),m.jsx(Fs,{...F,getOuter:p,children:(w,x)=>m.jsx(et.Provider,{value:x,children:m.jsx(te.Field,{...r,onMetaChange:w,children:nt(r,i,u)})})})]})}function Es(r){return h.createElement(r.noStyle?ws:Cs,r)}function xs(){const{validateStatus:r}=Ye.useState();return r}function Ms(r){return m.jsx(te.List,{...r})}const R=Object.assign(us,{ErrorList:st,Item:Object.assign(Es,{useStatus:xs}),List:Ms,useForm:tt,useFormInstance:cs,useWatch:Xe});function Ss(r){return m.jsx("input",{...r,value:r.value||"",style:{height:32}})}function ir(){return m.jsx(R,{children:m.jsx(R.Item,{label:"username",name:"username",children:m.jsx(Ss,{placeholder:"username"})})})}const ar={desc:{"zh-CN":`基础用法

`,"en-US":`基础用法 en

`},rawText:`\`\`\`tsx
import { Form } from '@mink-ui/core'

function Input(props: any) {
  return <input {...props} value={props.value || ''} style={{ height: 32 }} />
}

export default function App() {
  return (
    <Form>
      <Form.Item
        label="username"
        name="username"
      >
        <Input placeholder="username" />
      </Form.Item>
    </Form>
  )
}
\`\`\`
`,cssWrapName:"css8617b7295590bdbb59f833a73d634fd0"},C=r=>({status:"valid",value:r});function O(r){return(e,t)=>r.abortEarly&&!r.issue.isEmpty?Promise.reject(r.issue):(r.issue.addIssue(e,r.path,t),{status:"invalid"})}function _(r,e,t){return async(s,n)=>await r(s)?C(s):O(n)(e,{value:s,...t})}function Ps(r=[]){return r.reduce((e,t)=>ae(t)?`${e}[${t}]`:t.includes(".")?`${e}['${t}']`:e.length?`${e}.${t}`:`${t}`,"")}class A extends TypeError{constructor(){super(...arguments);l(this,"issues",[])}static ensure(t,s){const n=(t==null?void 0:t.path)||[];return{abortEarly:(t==null?void 0:t.abortEarly)??!1,issue:(t==null?void 0:t.issue)??new A,path:V(s)?n:n.concat(s)}}static format(t,s=[]){return(n={})=>{if(j(t))return t({...n,path:s});if(!le(t))return t;const i={...n,path:Ps(s)||"this"};return Object.entries(i).reduce((a,[o,u])=>{const c=new RegExp(`{#${o}}`,"g");return a.replace(c,String(u))},t)}}addIssue(t,s,n){const i=A.format(t,s)(n);this.issues.push({message:i,path:s})}addIssues(t){return this.issues=this.issues.concat(t),this}get isEmpty(){return!this.issues.length}get message(){const t=this.issues.map(s=>{try{return JSON.stringify(s.message),s.message}catch{return"error can not stringify"}});return JSON.stringify(t,null,2)}}const Fe={invalid:"{#path} is invalid",required:"{#path} is a required field"},S={email:"{#path} must be a valid email",invalid:"{#path} must be a string",length:"{#path} must be exactly {#length} characters",lowercase:"{#path} must be a lowercase string",max:"{#path} must be at most {#max} characters",min:"{#path} must be at least {#min} characters",range:"{#path} length be between {#min} and {#max}",regex:'{#path} must match the following: "{#regex}"',uppercase:"{#path} must be a upper case string",url:"{#path} must be a valid URL",uuid:"{#path} must be a valid UUID"},L={equal:"{#path} must be equal to {#equal}",integer:"{#path} must be an integer",invalid:"{#path} must be a number",max:"{#path} must be less than {#max}",min:"{#path} must be greater than {#min}",negative:"{#path} must be a negative number",positive:"{#path} must be a positive number",range:"{#path} be between {#min} and {#max}"},se={false:"{#path} field must be false",invalid:"{#path} must be a boolean",true:"{#path} field must be true"},re={invalid:"{#path} must be a date",max:"{#path} field must be at earlier than {#max}",min:"{#path} field must be later than {#min}"},ks={invalid:"{#path} must be a object",unknown:"{#path} field has unspecified keys: {#unknown}"},H={invalid:"{#path} must be a array",length:"{#path} must have {#length} items",max:"{#path} field must have less than or equal to {#max} items",min:"{#path} field must have at least {#min} items",nonempty:"{#path} must have at least one items"},js={invalid:"{#path} must be include {#enums}"},Ns={invalid:"{#path} is invalid union type"};class N{constructor(){l(this,"_In");l(this,"_Out");l(this,"rules",new Map)}_refine(e,t){return this.rules.set(e,t),this}_remove(e){return this.rules.delete(e),this}_validate(e,t){const s=[...this.rules.values()].map(n=>n(e,t));return Promise.all(s).then(n=>{for(let i=0,a=n.length;i<a;i++){const o=n[i];if(o.status==="invalid")return o}return C(e)})}nullable(){return E.nullable(this)}or(e){return Z.create([this,e])}preprocess(e){return E.preprocess(this,e)}refine(e,t=Fe.invalid){return E.refinement(this,e,t)}required(e=Fe.required){const t=s=>!V(s);return E.required(this,_(t,e))}transform(e){return E.transform(this,e)}union(e){return Z.create([this,e])}async validate(e,t){const s=A.ensure({...t,issue:void 0}),n=await this._validate(e,s);if(n.status==="valid")return n.value;throw s.issue}}class E extends N{constructor(e,t){super(),this.schema=e,this.options=t}static nullable(e){return new E(e,{type:"nullable"})}static preprocess(e,t){return new E(e,{handler:t,type:"preprocess"})}static refinement(e,t,s){const n=_(t,s);return new E(e,{handler:n,type:"refinement"})}static required(e,t){return new E(e,{handler:t,type:"required"})}static transform(e,t){return new E(e,{handler:t,type:"transform"})}get _type(){return this.options.type}async _validate(e,t){const{options:s}=this;if(s.type==="transform"){const i=await this.schema._validate(e,t);if(i.status==="invalid")return i;const a=await s.handler(e);return C(a)}if(s.type==="preprocess"){const i=await s.handler(e);return this.schema._validate(i,t)}if(s.type==="nullable")return Ae(e)?C(e):this.schema._validate(e,t);if(s.type==="required"){const i=await s.handler(e,t);return i.status==="invalid"?i:this.schema._validate(e,t)}const n=await this.schema._validate(e,t);return n.status==="invalid"?n:s.handler(e,t)}unwrap(){return this.schema}}class Z extends N{constructor(e){super(),this.inner=e}static create(e){return new Z(e)}async _validate(e,t){if(g(e))return C(e);const s=await Promise.all(this.inner.map(async n=>{const i=A.ensure(_e(t,["issue"]));try{return[i,await n._validate(e,i)]}catch(a){return[i,a]}}));for(let n=0,i=s.length;n<i;n++){const a=s[n][1];if(a.status==="valid")return a}for(let n=0,i=s.length;n<i;n++){const a=s[n][1];if(a.status==="invalid")return a}return O(t)(Ns.invalid,{value:e})}}class ue extends N{static create(){return new ue}_validate(e){return C(e)}}class ye extends N{constructor(e){super(),this.inner=e}static create(e){return new ye(e??ue.create())}async _validate(e,t){if(g(e))return C(e);if(!z(e))return O(t)(H.invalid,{value:e});const s=await super._validate(e,t);return s.status==="invalid"?s:this._validateInner(e,t)}async _validateInner(e,t){const s=e.map((n,i)=>{const a=A.ensure(t,i);return this.inner._validate(n,a)});return Promise.all(s).then(n=>{for(let i=0,a=n.length;i<a;i++){const o=n[i];if(o.status==="invalid")return o}return C(e)})}length(e,t=H.length){const s=n=>n.length===e;return this._refine("length",_(s,t,{length:e}))}max(e,t=H.max){const s=n=>n.length<=e;return this._refine("max",_(s,t,{max:e}))}min(e,t=H.min){const s=n=>n.length>=e;return this._refine("min",_(s,t,{min:e}))}nonempty(e=H.nonempty){return this.min(1,e)}get element(){return this.inner}}class Ie extends N{constructor(e=se.invalid){super(),this.message=e}static create(e=se.invalid){return new Ie(e)}_validate(e,t){return g(e)?C(e):qe(e)?super._validate(e,t):O(t)(this.message,{value:e})}false(e=se.false){const t=s=>s===!1;return this._refine("boolean",_(t,e))}true(e=se.true){const t=s=>s===!0;return this._refine("boolean",_(t,e))}}class Ve extends N{constructor(e=re.invalid){super(),this.message=e}static create(e=re.invalid){return new Ve(e)}_validate(e,t){return g(e)?C(e):!yt(e)||Number.isNaN(e.getTime())?O(t)(this.message,{value:e}):super._validate(e,t)}max(e,t=re.max){const s=n=>n<=e;return this._refine("max",_(s,t,{max:e}))}min(e,t=re.min){const s=n=>n>=e;return this._refine("min",_(s,t,{min:e}))}}class be extends N{constructor(e){super(),this.inner=e}static create(e){return new be(e)}_validate(e,t){return g(e)?C(e):this.inner.includes(e)?super._validate(e,t):O(t)(js.invalid,{enums:this.inner,value:e})}get enum(){return this.inner}}class $e extends N{constructor(e=L.invalid){super(),this.message=e}static create(e=L.invalid){return new $e(e)}_validate(e,t){return g(e)?C(e):!ae(e)||Number.isNaN(e)?O(t)(this.message,{value:e}):super._validate(e,t)}equal(e,t=L.equal){const s=n=>n===e;return this._refine("equal",_(s,t,{equal:e}))}integer(e=L.integer){const t=s=>Number.isInteger(s);return this._refine("integer",_(t,e))}max(e,t=L.max){const s=n=>n<=e;return this._refine("max",_(s,t,{max:e}))}min(e,t=L.min){const s=n=>n>=e;return this._refine("min",_(s,t,{min:e}))}negative(e=L.negative){const t=s=>s<0;return this._refine("negative",_(t,e))}positive(e=L.positive){const t=s=>s>0;return this._refine("positive",_(t,e))}range(e,t,s=L.range){const n=i=>i>=e&&i<=t;return this._refine("range",_(n,s,{max:t,min:e}))}}class we extends N{constructor(e){super(),this.inner=e}static create(e){return new we(e)}async _validate(e,t){if(g(e))return C(e);if(!U(e))return O(t)(ks.invalid,{value:e});const s=await super._validate(e,t);return s.status==="invalid"?s:this._validateInner(e,t)}async _validateInner(e,t){const s=Object.entries(this.shape).map(([n,i])=>{const a=A.ensure(t,n);return i._validate(e[n],a)});return Promise.all(s).then(n=>{for(let i=0,a=n.length;i<a;i++){const o=n[i][1];if(o.status==="invalid")return o}return C(e)})}passthrough(){return this._remove("strict"),this}get shape(){return this.inner}}const Ls=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/,Ds=/^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)$/,Us=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i;class Ce extends N{constructor(e=S.invalid){super(),this.message=e}static create(e=S.invalid){return new Ce(e)}_validate(e,t){return g(e)||e===""?C(e):le(e)?super._validate(e,t):O(t)(this.message,{value:e})}email(e=S.email){const t=s=>Ls.test(s);return this._refine("email",_(t,e))}length(e,t=S.length){const s=n=>n.length===e;return this._refine("length",_(s,t,{length:e}))}lowercase(e=S.lowercase){const t=s=>s===s.toLowerCase();return this._refine("lowercase",_(t,e))}max(e,t=S.max){const s=n=>n.length<=e;return this._refine("max",_(s,t,{max:e}))}min(e,t=S.min){const s=n=>n.length>=e;return this._refine("min",_(s,t,{min:e}))}range(e,t,s=S.range){const n=i=>i.length>=e&&i.length<=t;return this._refine("range",_(n,s,{max:t,min:e}))}regex(e,t=S.regex){const s=n=>e.test(n);return this._refine("regex",_(s,t,{regex:e}))}required(e=Fe.required){const t=s=>!(V(s)||s==="");return E.required(this,_(t,e))}uppercase(e=S.uppercase){const t=s=>s===s.toUpperCase();return this._refine("uppercase",_(t,e))}url(e=S.url){const t=s=>Ds.test(s);return this._refine("url",_(t,e))}uuid(e=S.uuid){const t=s=>Us.test(s);return this._refine("uuid",_(t,e))}}const Os=Ce.create,Ts=$e.create,qs=Ie.create,zs=we.create,As=ue.create,Ws=ye.create,Rs=be.create,Bs=Ve.create,Gs=Z.create,Hs=E.refinement,{preprocess:Ks,refinement:lr,transform:Js}=E,Ne={any:As,array:Ws,boolean:qs,date:Bs,enums:Rs,number:Ts,object:zs,preprocess:Ks,refine:Hs,string:Os,transform:Js,union:Gs};function Le(r){return m.jsx("input",{...r,value:r.value||"",style:{height:32}})}function or(){return m.jsxs(R,{labelCol:{span:4},onFinish:r=>{console.log("finish",r)},onFailed:r=>{console.log("failed",r)},children:[m.jsx(R.Item,{label:"username",name:"username",rule:Ne.string().min(3).max(7).required(),children:m.jsx(Le,{placeholder:"username"})}),m.jsx(R.Item,{label:"email",name:"email",rule:Ne.string().email().required(),children:m.jsx(Le,{placeholder:"username"})}),m.jsx(R.Item,{wrapperCol:{offset:4},children:m.jsx(pt,{type:"submit",children:"submit"})})]})}const ur={desc:{"zh-CN":"使用 `@mink-ui/emator` 可以获得类似 `zod`, `joi` 之类的开发体验\n\n","en-US":"使用 `@mink-ui/emator` 可以获得类似 `zod`, `joi` 之类的开发体验\n\n"},rawText:`\`\`\`tsx
import { Button, Form } from '@mink-ui/core'
import ema from '@mink-ui/emator'

function Input(props: any) {
  return <input {...props} value={props.value || ''} style={{ height: 32 }} />
}

export default function App() {
  return (
    <Form
      labelCol={{ span: 4 }}
      onFinish={(values) => {
        console.log('finish', values)
      }}
      onFailed={(values) => {
        console.log('failed', values)
      }}
    >
      <Form.Item
        label="username"
        name="username"
        rule={ema.string().min(3).max(7).required()}
      >
        <Input placeholder="username" />
      </Form.Item>

      <Form.Item
        label="email"
        name="email"
        rule={ema.string().email().required()}
      >
        <Input placeholder="username" />
      </Form.Item>

      <Form.Item wrapperCol={{ offset: 4 }}>
        <Button type="submit">submit</Button>
      </Form.Item>
    </Form>
  )
}
\`\`\`
`,cssWrapName:"css85e3116db8bfc0acd87a7ef30192ad30"};function cr(){return m.jsx("div",{children:"建设中,敬请期待!"})}const dr={desc:{"zh-CN":"TODO","en-US":"TODO"},rawText:"```tsx\nexport default function App() {\n  return <div>建设中,敬请期待!</div>\n}\n```",cssWrapName:"cssdb8cf4f382526efa6f0cf7413b221ae6"};export{ir as A,ur as a,or as b,dr as c,cr as d,ar as i};
